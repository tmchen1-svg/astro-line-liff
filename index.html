<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨­å®šæ˜Ÿç›¤è³‡æ–™</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; padding: 20px; background-color: #f5f5f5; }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #333; margin-bottom: 20px; }
        label { display: block; margin: 15px 0 5px; color: #666; font-size: 14px; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        button { width: 100%; padding: 15px; margin-top: 30px; background-color: #06c755; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; }
        button:active { background-color: #05b34c; }
    </style>
</head>
<body>
    <div class="card">
        <h2>ğŸ”® é–‹å•Ÿæ‚¨çš„é­”æ³•æ—…ç¨‹</h2>
        
        <label>ğŸ“… å‡ºç”Ÿæ—¥æœŸ</label>
        <input type="date" id="date" required>
        
        <label>â° å‡ºç”Ÿæ™‚é–“</label>
        <input type="time" id="time" required>
        
        <label>ğŸ“ å‡ºç”ŸåŸå¸‚</label>
        <input type="text" id="city" placeholder="ä¾‹å¦‚ï¼šå°åŒ—å¸‚" value="å°åŒ—å¸‚">

        <button id="btn" onclick="send()">ç¢ºèªé€å‡º</button>
    </div>

    <script>
        // é€™è£¡ç­‰ä¸€ä¸‹è¦å¡«å…¥æ‚¨çš„ LIFF ID
        const LIFF_ID = "2008499274-1XAzG3rb";

        // åˆå§‹åŒ–
        liff.init({ liffId: LIFF_ID }).catch(err => {
            alert("å•Ÿå‹•å¤±æ•—ï¼Œè«‹ç¢ºèªæ˜¯åœ¨ LINE ä¸­é–‹å•Ÿ");
        });

    function send() {
    const d = document.getElementById('date').value;
    const t = document.getElementById('time').value; // é€™è£¡æ˜¯ 24 å°æ™‚åˆ¶æ ¼å¼ï¼Œå¦‚ "22:55"
    const c = document.getElementById('city').value;

    if (!d || !t || !c) {
        alert("è«‹å®Œæ•´å¡«å¯«è³‡æ–™å–”ï¼");
        return;
    }

    // --- æ–°å¢ï¼šæ ¼å¼åŒ–æ™‚é–“çµ¦ä½¿ç”¨è€…å†æ¬¡ç¢ºèª ---
    const [hour, minute] = t.split(':');
    const h = parseInt(hour);
    const period = h >= 12 ? "ä¸‹åˆ (PM)" : "ä¸Šåˆ (AM)";
    const displayH = h > 12 ? h - 12 : h;
    
    // å½ˆå‡ºç¢ºèªè¦–çª—ï¼Œæ˜ç¢ºé¡¯ç¤ºã€Œä¸Šåˆ/ä¸‹åˆã€
    const confirmMsg = `æ‚¨é¸æ“‡çš„æ˜¯ï¼š\n${d}\n${period} ${displayH}:${minute}\n${c}\n\nç¢ºèªé€å‡ºå—ï¼Ÿ`;
    
    if (!confirm(confirmMsg)) {
        return; // ä½¿ç”¨è€…æŒ‰å–æ¶ˆï¼Œå°±ä¸é€å‡º
    }
    // --------------------------------------

    const command = `/birth ${d} ${t} ${c}`;

    liff.sendMessages([{ type: 'text', text: command }])
        .then(() => liff.closeWindow())
        .catch(err => alert("ç™¼é€å¤±æ•—ï¼Œè«‹ç¢ºèªæ‚¨å·²åŠ å…¥å¥½å‹ä¸¦å…è¨±å‚³è¨Š"));
}
    </script>
</body>
</html>
